#{extends 'results/Results/layout.html' /}

<div id="crudIndex">

    <h2>&{'Results'}: ${result.pollingStationBallot.pollingStation.code} / ${result.pollingStationBallot.pollingStation.name}</h2>
    <div class="container_12 clearfix">
        <div class="grid_7">
        <table>
            <thead>
                <tr>
                    <th>&{'Results'}</th>
                    <th width="20%">&{'votes'}</th>
                    <th width="20%">&{'percentage_over_votes'}</th>
                    <th width="20%">&{'percentage_over_census'}</th>
                </tr>
            </thead>
            <tbody>
                #{list items:result.parties, as:'party'}
                    <tr>
                        <td>
                            &{party.name}
                        </td>
                        <td class="crudNew" >
                            ${result.getResult(party)}
                        </td>
                        <td class="crudNew" >
                            ${result.getPercentageOverVotes(party)?.format('0.00')}
                        </td>
                        <td class="crudNew" >
                            ${result.getPercentageOverCensus(party)?.format('0.00')}
                        </td>
                    </tr>
                #{/list}
                <tr>
                    <td>
                        &{'Nulls'}
                    </td>
                    <td class="crudNew" >
                        ${result.nullVoteAmount}
                    </td>
                    <td class="crudNew">
                    </td>
                    <td class="crudNew">
                        ${result.getNullVotePercentageOverCensus()?.format('0.00')}
                    </td>
                </tr>
                <tr>
                    <td>
                        &{'Whites'}
                    </td>
                    <td class="crudNew" >
                        ${result.whiteVoteAmount}
                    </td>
                    <td class="crudNew">
                        ${result.getWhiteVotePercentageOverVotes()?.format('0.00')}
                    </td>
                    <td class="crudNew">
                        ${result.getWhiteVotePercentageOverCensus()?.format('0.00')}
                    </td>
                </tr>
                <tr>
                    <td>
                        &{'Abstentions'}
                    </td>
                    <td class="crudNew" >
                        ${result.abstentions}
                    </td>
                    <td></td>
                    <td class="crudNew">
                        ${result.getAbstentionsPercentage()?.format('0.00')}
                    </td>
                </tr>
                <tr>
                    <td>
                        &{'Census'}
                    </td>
                    <td class="crudNew" >
                        ${result.census}
                    </td>
                    <td></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        </div>
        <div class="grid_5">

    <div id="chart_div"></div>

        </div>

         <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Alderdia');
        data.addColumn('number', 'Botoak');
        data.addRows(${result.parties.size + 3});
        
        #{list items:result.parties, as:'party'}
        data.setValue(${party_index - 1}, 0, '&{party.name}');
        data.setValue(${party_index - 1}, 1, ${result.getResult(party)});
        #{/list}

        data.setValue(${result.parties.size}, 0, '&{'Nulls'}');
        data.setValue(${result.parties.size}, 1, ${result.nullVoteAmount});
        data.setValue(${result.parties.size +1}, 0, '&{'Whites'}');
        data.setValue(${result.parties.size +1}, 1, ${result.whiteVoteAmount});
        data.setValue(${result.parties.size +2}, 0, '&{'Abstentions'}');
        data.setValue(${result.parties.size +2}, 1, ${result.abstentions});

        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        chart.draw(data, {width: 380, height: 300});
      }
    </script>

    </div>

</div>